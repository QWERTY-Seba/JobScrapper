<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!DOCTYPE html>
<html>
<head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>

<body>
    <p>This add-in will set cell A1 to the value 'Hello world!'.</p>
    <button id="pasteClipboard">pasteClipboard</button>

</body>

<script>
Office.onReady((info) => {});
Office.initialize = function () {
    Office.context.document.registerCommand("pasteClipboard", pasteClipboard, {icon: "paste", title: "Paste Clipboard"});
    Office.context.document.addHandlerAsync(Office.EventType.DocumentEvents.OnAccessKey, pasteClipboard);
};
function pasteClipboard() {
    navigator.clipboard.readText().then(clipText => {
        Excel.run(function (ctx) {
            var sheet = ctx.workbook.worksheets.getActiveWorksheet();
            sheet.getRange("A1").values = clipText;
            return ctx.sync();
        }).catch(errorHandler);
    });
}


</script>

</html>